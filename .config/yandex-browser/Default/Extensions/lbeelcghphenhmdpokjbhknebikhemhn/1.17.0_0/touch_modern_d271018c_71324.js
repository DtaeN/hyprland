"use strict";(self.webpackChunkv4fire_1=self.webpackChunkv4fire_1||[]).push([[71324],{71324:(e,t,o)=>{o.r(t),o.d(t,{$$:()=>h,ASYNC_RENDER_ID:()=>r.ASYNC_RENDER_ID,ComponentEvent:()=>r.ComponentEvent,ComponentInterface:()=>r.ComponentInterface,ComponentResetType:()=>r.ComponentResetType,ElementModEvent:()=>r.ElementModEvent,FeatureManager:()=>r.FeatureManager,InferComponentEvents:()=>r.InferComponentEvents,InferEvents:()=>r.InferEvents,ModEvent:()=>r.ModEvent,ModEventName:()=>r.ModEventName,ModEventReason:()=>r.ModEventReason,ModEventType:()=>r.ModEventType,Module:()=>r.Module,PARENT:()=>r.PARENT,SetElementModEvent:()=>r.SetElementModEvent,SetModEvent:()=>r.SetModEvent,Theme:()=>r.Theme,V4_COMPONENT:()=>r.V4_COMPONENT,app:()=>r.app,bindRemoteWatchers:()=>r.bindRemoteWatchers,callMethodFromComponent:()=>r.callMethodFromComponent,canSkipWatching:()=>r.canSkipWatching,component:()=>r.component,computed:()=>r.computed,customWatcherRgxp:()=>r.customWatcherRgxp,default:()=>g,defaultConfig:()=>l,destroyApp:()=>r.destroyApp,dsComponentsMods:()=>r.dsComponentsMods,extractWebappShortName:()=>r.extractWebappShortName,field:()=>r.field,gc:()=>r.gc,getComponentMods:()=>r.getComponentMods,getComponentName:()=>r.getComponentName,getFieldsStore:()=>r.getFieldsStore,getInfoFromConstructor:()=>r.getInfoFromConstructor,getPropertyInfo:()=>r.getPropertyInfo,globalEmitter:()=>r.globalEmitter,hook:()=>r.hook,init:()=>r.init,initEmitter:()=>r.initEmitter,isAbstractComponent:()=>r.isAbstractComponent,isBinding:()=>r.isBinding,isComponent:()=>r.isComponent,isCustomWatcher:()=>r.isCustomWatcher,isPrivateField:()=>r.isPrivateField,isPropGetter:()=>r.isPropGetter,isSmartComponent:()=>r.isSmartComponent,isStore:()=>r.isStore,modsInitializer:()=>r.modsInitializer,normalizeClass:()=>r.normalizeClass,normalizeStyle:()=>r.normalizeStyle,paramsFactory:()=>r.paramsFactory,prop:()=>r.prop,resetComponents:()=>r.resetComponents,rootComponents:()=>r.rootComponents,runHook:()=>r.runHook,statuses:()=>r.statuses,system:()=>r.system,wait:()=>r.wait,watch:()=>r.watch});var n=o(31635),s=o(73756),i=o(10497),a=o(40948),r=o(27385);const l={actionClose:!0,overlayLatency:1..second(),autoClose:3..second(),position:"bottom"};var c=o(8499);const p=(0,s.A)(["onToastOpened","onToastClosed"]);class ConfigManager extends c.A{constructor(e){super(e),this.configs=[],this.ctx.on("afterOpenAttempt",((e,t)=>{null!=(null==t?void 0:t.resolve)&&t.resolve(e)}),{label:p.onToastOpened}),this.ctx.on("afterCloseAttempt",(()=>{const e=this.configs.shift();null!=e&&this.ctx.open(e)}),{label:p.onToastClosed})}push(e){const t={...e};return!0===t.toQueue?this.configs.push(t):(this.configs.unshift(t),this.ctx.close(!1)),new Promise((e=>{t.resolve=e}))}clear(){this.configs.length=0}}var m;o(54081);const h=(0,s.A)(["toastOpening","sleepOnOpen","open","toastClosing","autoClose","removeNode","navbarElement","changeVisibleHeight"]);let d=m=class bToast extends r.default{constructor(){super(...arguments),this.defaultConfig=l,this.config=void 0,this.lastClosedTimestamp=0}get openedConfigId(){var e;return null===(e=this.config)||void 0===e?void 0:e.id}callControlAction(e,...t){return Object.cast(a.A.callControlAction(this,e,...t))}getControlEvent(e){return"b-button"===e.component?"click:component":"click"}async open(e){const t=this.r.getFromStore(this.componentName);if(Object.forEach(t,((e,t)=>{this.isComponent(e,m)&&t!==this.componentId&&"true"===e.mods.opened&&e.close()})),null!=this.config)return Object.isTruly(this.config.autoClose)||(this.config.autoClose=l.autoClose,this.resetCloseTimeout()),this.configManager.push(e);const o={...this.defaultConfig,...e};void 0!==o.icon&&void 0!==o.button&&(this.log({logLevel:"warn",context:`${this.componentName}:open`},'Incorrect configuration: you can use only button or only icon. The field "icon" will be removed.'),delete o.icon),this.config=o,await this.async.clearAll({label:h.sleepOnOpen,group:"open"});const n=Date.now()-this.lastClosedTimestamp;let{overlayLatency:s}=this.config;null==s||n>s?s=0:s-=n,s>0&&await this.async.sleep(s,{label:h.sleepOnOpen,group:"open",join:!0}),Object.isDictionary(this.config.analyticsParams)&&this.analytics.sendEvent("appear",{...this.externalAnalyticsParams,...this.config.analyticsParams},"toast"),null!=this.config.onBeforeOpen&&await this.config.onBeforeOpen(this.$refs.rootWrapper),this.resetCloseTimeout();const a=await this.async.promise(i.A.open(this),{label:h.open,group:"open"});return this.emit("afterOpenAttempt",a,this.config),a}async close(e=!0){this.async.clearAll({group:"open"}),e&&this.configManager.clear();const{config:t}=this,o=await i.A.close(this);return this.config=void 0,this.lastClosedTimestamp=Date.now(),o&&Object.isDictionary(null==t?void 0:t.analyticsParams)&&this.analytics.sendEvent("close",{...this.externalAnalyticsParams,...null==t?void 0:t.analyticsParams},"toast"),null!=(null==t?void 0:t.onAfterClose)&&await t.onAfterClose(this.$refs.rootWrapper),this.emit("afterCloseAttempt",o,t),o}async onKeyClose(){}async onTouchClose(e){var t;if(null===(t=this.config)||void 0===t?void 0:t.actionClose){var o;const t=e.target;if(!t)return;const n=null===(o=this.block)||void 0===o?void 0:o.getElementSelector("control");Object.isString(n)&&!t.closest(n)&&t.closest(`.${this.componentId}`)&&await this.close()}}resetCloseTimeout(){var e;Object.isNumber(null===(e=this.config)||void 0===e?void 0:e.autoClose)&&this.async.setTimeout(this.close.bind(this,!1),this.config.autoClose,{label:h.autoClose,group:"open"})}async onOpenedChange(){}initCloseHelpers(){i.A.initCloseHelpers(this,{touch:"click touchmove"})}initModEvents(){i.A.initModEvents(this)}insertNode(){const e=`${this.componentName}.${this.componentId}`,t={label:h.removeNode,join:!0},o=this.$el;document.body.insertAdjacentElement("afterbegin",o),this.r.setToStore(e,this.componentId),this.async.worker((()=>{var t;null===(t=this.$el)||void 0===t||t.remove(),this.r.setToStore(e,void 0)}),t)}async onVisibleHeightChanged(){await this.waitRef("rootWrapper",{label:h.navbarElement,join:"replace"}),this.async.requestAnimationFrame((()=>{const e=this.remoteState.visibleHeight,{clientHeight:t}=document.documentElement,o=t-e;this.$refs.rootWrapper.style.transform=o>=0?`translateY(-${o.px})`:"translateY(0px)"}),{label:h.changeVisibleHeight})}};d.mods={...i.A.mods,opened:["true",["false"]],position:["top",["bottom"]],contentDirection:["column",["row"]],contentOffsets:["none"]},(0,n.Cg)([(0,r.system)((e=>new ConfigManager(e)))],d.prototype,"configManager",void 0),(0,n.Cg)([(0,r.prop)(Object)],d.prototype,"defaultConfig",void 0),(0,n.Cg)([(0,r.field)()],d.prototype,"config",void 0),(0,n.Cg)([(0,r.system)()],d.prototype,"lastClosedTimestamp",void 0),(0,n.Cg)([(0,r.wait)({label:h.toastOpening,defer:!0})],d.prototype,"open",null),(0,n.Cg)([(0,r.wait)({label:h.toastClosing,defer:!0})],d.prototype,"close",null),(0,n.Cg)([(0,r.hook)("beforeDataCreate")],d.prototype,"initCloseHelpers",null),(0,n.Cg)([(0,r.hook)("mounted")],d.prototype,"insertNode",null),(0,n.Cg)([(0,r.watch)(["!globalEmitter:native.ui.visibleHeightChanged","!window:resize"]),(0,r.hook)("mounted")],d.prototype,"onVisibleHeightChanged",null),d=m=(0,n.Cg)([(0,r.component)({layer:"@edadeal/core"})],d);const g=d}}]);